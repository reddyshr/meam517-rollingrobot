#-----------------------------------------------------------------------
# Submakefile :: cmex
#-----------------------------------------------------------------------

cmexSNLIBS    = libsnopt7mex
cmexLIBS      = $(cmexSNLIBS:%=$(libdir)/%.a)

CMEXFILES     = snoptcmex mexUtility snoptprobdef snoptprint sncmexlog s_copy
CMEX_SRC      = $(CMEXFILES:%=$(CMEX_SRCDIR)/%.c)

#-----------------------------------------------------------------------

cmex: all_cmex
clean: clean_cmex
veryclean: veryclean_cmex
distclean: veryclean_cmex

all_cmex: install_snmex snoptcmex

snoptcmex:
	$(LINK_MEX) -v $(MEXFLAGS) $(CMEX_SRC) \
	CC='$(CC)' CLIBS='$$CLIBS $(CLIBS) $(FCLIBS)' LD='$(CC)' \
	LDFLAGS='$$LDFLAGS $(blasLIB)' \
	$(cmexLIBS) -o $@ -output snoptmex -outdir $(CMEX_SRCDIR)
	@echo "SNOPT cmex files installed in ${CMEX_SRCDIR}"

#-----------------------------------------------------------------------

clean_cmex:

veryclean_cmex: clean_cmex
	$(CLEAN) rm -f $(MATDIR)/snoptmex.*

#-----------------------------------------------------------------------

#.PRECIOUS: $(CMEX_OBJDIR)/%.c

.PHONY: all_cmex install_cmex uninstall_cmex clean_cmex veryclean_cmex

